
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>flask_restful_dbbase.resources.dbbase_resource &#8212; Flask-RESTful-DBBase 0.3.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
     
    
    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
    
    

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Flask-RESTful-DBBase 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../flask_restful_dbbase.html" accesskey="U">flask_restful_dbbase</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for flask_restful_dbbase.resources.dbbase_resource</h1><div class="highlight"><pre>
<span></span><span class="c1"># flask_restful_dbbase/resources/dbbase_resource.py</span>
<span class="sd">&quot;&quot;&quot;&quot;</span>
<span class="sd">This module implements a starting point for model resources.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">inflect</span>

<span class="kn">from</span> <span class="nn">flask_restful</span> <span class="kn">import</span> <span class="n">Resource</span>
<span class="kn">from</span> <span class="nn">dbbase.utils</span> <span class="kn">import</span> <span class="n">xlate</span>

<span class="kn">from</span> <span class="nn">..doc_utils</span> <span class="kn">import</span> <span class="n">MetaDoc</span>


<div class="viewcode-block" id="DBBaseResource"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource">[docs]</a><span class="k">class</span> <span class="nc">DBBaseResource</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DBBaseResource Class</span>

<span class="sd">    This model class implements the base class.</span>

<span class="sd">    model_class: a dbbase.Model</span>
<span class="sd">    url_prefix: the portion of the path leading up to the resource,</span>
<span class="sd">    for example: /api/v2</span>

<span class="sd">    url_name: the url_name defaults to a lower case version of the</span>
<span class="sd">    the model_class name if left as None, but can have an explicit</span>
<span class="sd">    name if necessary.</span>

<span class="sd">    serial_fields: if left as None, it uses the serial list from</span>
<span class="sd">    the model class. Left as None, it will default to the</span>
<span class="sd">    underlying model.</span>

<span class="sd">    serial_field_relations: can customize how relationship variables</span>
<span class="sd">    are presented in output.</span>

<span class="sd">    before_commit/after_commit: These variables are designed to extend</span>
<span class="sd">    the capabilities of the methods be enabling a function or</span>
<span class="sd">    class to modify the data just prior to commit, or after. By</span>
<span class="sd">    using these, it is possible to send data to message queues,</span>
<span class="sd">    adjust the data, or otherwise change the data.</span>

<span class="sd">    There are expectations of about the functions/classes.</span>

<span class="sd">    Format for a before/after function:</span>

<span class="sd">    `def myfunc(resource_self, item, status_code):`</span>

<span class="sd">    Args:</span>
<span class="sd">        resource_self: (obj) : This is the self of the resource.</span>
<span class="sd">            This provides access to the resource itself.</span>
<span class="sd">        item: (obj) : This is the SQLAlchemy object.</span>
<span class="sd">        status_code (int) : If due to the processing that status_code</span>
<span class="sd">            should change, you can change it here. Otherwise, simply</span>
<span class="sd">            return it.</span>
<span class="sd">    Returns:</span>
<span class="sd">        item: (obj) : The modified record</span>
<span class="sd">        status_code (int) : The possibly altered response status_code</span>

<span class="sd">    Example of a Class:</span>

<span class="sd">    A class can be used to hold additional data.</span>
<span class="sd">    This example shows how a resource can receive a POSTed object, but</span>
<span class="sd">    return the job created as a result instead.</span>

<span class="sd">    A class requires that a `run` function be implemented with the</span>
<span class="sd">    input variables as shown below.</span>

<span class="sd">    class JobCreator(object):</span>
<span class="sd">        def __init__(self, class_name):</span>
<span class="sd">            self.Job = class_name</span>

<span class="sd">        def run(self, resource_self, item, status_code):</span>
<span class="sd">            # obj_self gives access resource characteristics</span>
<span class="sd">            # but not used in this case</span>
<span class="sd">            data = item.to_dict(to_camel_case=False)</span>
<span class="sd">            job = self.Job()</span>
<span class="sd">            job = self.Job(</span>
<span class="sd">                owner_id=data[&#39;owner_id&#39;],</span>
<span class="sd">                model_id=data[&#39;id&#39;],</span>
<span class="sd">                job_type_id=0,</span>
<span class="sd">                status_id=0</span>
<span class="sd">            ).save()</span>
<span class="sd">            if resource_self.serial_fields is None:</span>
<span class="sd">                resource_self.serial_fields = {}</span>
<span class="sd">            resource_self.serial_fields[&#39;post&#39;] = \</span>
<span class="sd">                self.Job.get_serial_fields()</span>

<span class="sd">            # job submitted here -&gt;</span>

<span class="sd">            status_code = 202</span>
<span class="sd">            return job, status_code</span>

<span class="sd">    meta_doc: This set of attributes is designed to supplement meta</span>
<span class="sd">    information automatically generated. It uses the MetaDoc class</span>
<span class="sd">    found in utils.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_class</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">model_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The string version of the Model class name. This is set</span>
<span class="sd">    upon initialization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">url_prefix</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span>

    <span class="n">url_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">use_date_conversions</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    use_date_conversions can be used if the database, such as SQlite3 does</span>
<span class="sd">    not support the acceptance of string-based dates. Since it takes processing</span>
<span class="sd">    time and adherence to a format, it is an optional feature.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># output params</span>
    <span class="n">serial_fields</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">serial_field_relations</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">before_commit</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">after_commit</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">default_sort</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">requires_parameter</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">meta_doc</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;A model class must be set for this resource to function.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="n">_class</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

<div class="viewcode-block" id="DBBaseResource.get_key_names"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource.get_key_names">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_key_names</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">formatted</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; get_key_names</span>

<span class="sd">        This function returns column names marked as primary_key.</span>

<span class="sd">        Args:</span>
<span class="sd">            formatted: (bool) : will return in form [&lt;int:id&gt;]</span>

<span class="sd">        Returns:</span>
<span class="sd">            key_names (list) : a list of keys is returned</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">primaries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;expression&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">expression</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">expression</span><span class="o">.</span><span class="n">primary_key</span><span class="p">:</span>
                        <span class="n">primaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">formatted</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">primaries</span><span class="p">:</span>
                <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">cls</span><span class="o">.</span><span class="n">format_key</span><span class="p">(</span>
                        <span class="n">key</span><span class="p">,</span>
                        <span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">doc_column</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="p">,</span> <span class="n">key</span><span class="p">)[</span>
                            <span class="s2">&quot;type&quot;</span>
                        <span class="p">],</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="n">primaries</span>

        <span class="k">return</span> <span class="n">keys</span></div>

<div class="viewcode-block" id="DBBaseResource.get_obj_params"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource.get_obj_params">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_obj_params</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get_obj_params</span>

<span class="sd">        This is a convenience function for getting documentation</span>
<span class="sd">        parameters from the model class.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict) : The object properties of the model class</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">doc_table</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="p">)[</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="n">_class</span><span class="p">()</span>
        <span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="DBBaseResource.format_key"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource.format_key">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">format_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">key_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns the portion of the URL that embodies the key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key: (str) : The name of the key field.</span>
<span class="sd">            key_type: (str) : Either &#39;integer&#39; or something else.</span>

<span class="sd">        Returns:</span>

<span class="sd">            formatted key: (str) : such as &lt;int:id&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key_type</span> <span class="o">==</span> <span class="s2">&quot;integer&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;int:</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&gt;&quot;</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;string:</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&gt;&quot;</span></div>

<div class="viewcode-block" id="DBBaseResource.get_urls"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource.get_urls">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_urls</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;get_urls</span>

<span class="sd">        This function returns something similar to</span>
<span class="sd">            [ {url_prefix}/{this_url}, {url_prefix}/{this_url}/&lt;int:id&gt; ]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;A model class must be defined&quot;</span><span class="p">)</span>

        <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">create_url</span><span class="p">()]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">is_collection</span><span class="p">():</span>
            <span class="n">key_methods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;get&quot;</span><span class="p">,</span> <span class="s2">&quot;put&quot;</span><span class="p">,</span> <span class="s2">&quot;patch&quot;</span><span class="p">,</span> <span class="s2">&quot;delete&quot;</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">key_methods</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
                    <span class="c1"># create a URL with a key</span>
                    <span class="n">keys</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_key_names</span><span class="p">(</span><span class="n">formatted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">keys</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
                    <span class="n">url_with_key</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">urls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">keys</span><span class="p">])</span>
                    <span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url_with_key</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">urls</span></div>

<div class="viewcode-block" id="DBBaseResource.get_meta"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource.get_meta">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_meta</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns the settings for the resource.</span>

<span class="sd">        Args:</span>
<span class="sd">            method: (str : None) : choices are get/post/put/patch/delete.</span>

<span class="sd">        Returns:</span>
<span class="sd">            meta_data (dict) : A dict with the resource characteristics.</span>
<span class="sd">            If a method is preferred, the focus will be narrowed to that</span>
<span class="sd">            method.</span>

<span class="sd">        The intent of this function is to show relevant information for someone</span>
<span class="sd">        interacting with an API.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">meta_doc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">meta_doc</span> <span class="o">=</span> <span class="n">MetaDoc</span><span class="p">(</span><span class="n">resource_class</span><span class="o">=</span><span class="bp">cls</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">meta_doc</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span></div>

<div class="viewcode-block" id="DBBaseResource.is_collection"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource.is_collection">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">is_collection</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function returns True if identified as a collection resource.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># uses max_page_size as a marker</span>
        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;max_page_size&quot;</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_all_keys_found</span><span class="p">(</span><span class="n">key_names</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key_names</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="p">{</span><span class="n">key_names</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="n">key_names</span><span class="p">]}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">new_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key_name</span> <span class="ow">in</span> <span class="n">key_names</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key_name</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">new_dict</span><span class="p">[</span><span class="n">key_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key_name</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">count</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_names</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">new_dict</span>

        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">_check_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># these are the kwargs passed in</span>
        <span class="c1"># kwargs without ** is intentional</span>
        <span class="n">key_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_key_names</span><span class="p">()</span>
        <span class="n">status</span><span class="p">,</span> <span class="n">kdict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_keys_found</span><span class="p">(</span><span class="n">key_names</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">kdict</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">key_names</span> <span class="o">=</span> <span class="n">key_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;This method requires the </span><span class="si">{</span><span class="n">key_names</span><span class="si">}</span><span class="s2"> in the URL for &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model_name</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_serial_fields</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">with_class</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;_get_serial_fields</span>

<span class="sd">        see class description for use</span>

<span class="sd">        If with_class a foreign class will be included:</span>
<span class="sd">        example:</span>
<span class="sd">            model_class = &quot;MlModels&quot;</span>
<span class="sd">            serial_fields = {</span>
<span class="sd">                &quot;get&quot;: [&#39;id, &#39;model_name&#39;]</span>
<span class="sd">                &quot;post&quot;: {Job: [&#39;id&#39;, &#39;job_type_id&#39;]}</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">serial_fields</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">serial_fields</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">serial_fields</span><span class="p">:</span>
                <span class="n">serial_fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">serial_fields</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">serial_fields</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">serial_fields</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">serial_fields</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">with_class</span><span class="p">:</span>
            <span class="c1"># dict is only used with meta information</span>
            <span class="n">serial_fields</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">serial_fields</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">serial_fields</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_serial_field_relations</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;_get_serial_field_relations</span>

<span class="sd">        see class description for use</span>
<span class="sd">        These are handled differently than serial lists because they are</span>
<span class="sd">        not subject to the filtering through stop list on the model class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">serial_field_relations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">serial_field_relations</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">serial_field_relations</span><span class="p">:</span>
                <span class="n">serial_field_relations</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">serial_field_relations</span><span class="p">[</span><span class="n">method</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">serial_field_relations</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">serial_field_relations</span>

        <span class="k">if</span> <span class="n">serial_field_relations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">serial_field_relations</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="n">SERIAL_FIELD_RELATIONS</span>

        <span class="c1"># NOTE: think about this one</span>
        <span class="c1"># if isinstance(serial_field_relations, dict):</span>
        <span class="c1">#     # dict is only used with meta information</span>
        <span class="c1">#     serial_field_relations = serial_field_relations.values()[0]</span>

        <span class="k">return</span> <span class="n">serial_field_relations</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_serializations</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_get_serial_fields</span><span class="p">(</span><span class="n">method</span><span class="p">),</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_get_serial_field_relations</span><span class="p">(</span><span class="n">method</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_check_config_error</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;_check_config_error</span>

<span class="sd">        This function returns a message, response code</span>
<span class="sd">        if the model_class has not been configured.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;Configuration error: missing model_class.&quot;</span><span class="p">},</span>
                <span class="mi">500</span><span class="p">,</span>
            <span class="p">)</span>

<div class="viewcode-block" id="DBBaseResource.create_url"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource.create_url">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_url</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; create_url</span>

<span class="sd">        Url can come from:</span>
<span class="sd">        * url_name resource variable</span>

<span class="sd">        but if None</span>
<span class="sd">        * snake_case version of class name</span>

<span class="sd">        NOTE: figure out flag for use table/classname</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_check_config_error</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">url_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># attempt to derive it</span>
            <span class="n">_pluralizer</span> <span class="o">=</span> <span class="n">inflect</span><span class="o">.</span><span class="n">engine</span><span class="p">()</span>
            <span class="n">url_name</span> <span class="o">=</span> <span class="n">xlate</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">model_class</span><span class="o">.</span><span class="n">_class</span><span class="p">(),</span> <span class="n">camel_case</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">url_name</span> <span class="o">=</span> <span class="n">_pluralizer</span><span class="o">.</span><span class="n">plural</span><span class="p">((</span><span class="n">url_name</span><span class="p">))</span>
            <span class="n">url_name</span> <span class="o">=</span> <span class="n">url_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url_name</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">url_name</span>

        <span class="n">url_prefix</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">url_prefix</span>

        <span class="k">return</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url_prefix</span><span class="p">,</span> <span class="n">url_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="DBBaseResource.screen_data"><a class="viewcode-back" href="../../../flask_restful_dbbase.resources.html#flask_restful_dbbase.resources.DBBaseResource.screen_data">[docs]</a>    <span class="k">def</span> <span class="nf">screen_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">obj_params</span><span class="p">,</span> <span class="n">skip_missing_data</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assumes data is deserialized</span>

<span class="sd">        This function screens data from a few parameters, missing data,</span>
<span class="sd">        unneeded fields in data, excessive string lengths, improper numbers.</span>

<span class="sd">        Note that this function does not exhaustively determine the</span>
<span class="sd">        problem. It ends on first failure.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: (dict) : incoming data</span>
<span class="sd">            obj_params: (dict) : table parameters</span>
<span class="sd">            skip_missing_data : (bool) : Flag to check for all for record</span>

<span class="sd">        Returns:</span>
<span class="sd">            status: (bool) : True, Successful screening</span>
<span class="sd">            msg : (None : dict) : description of the problem</span>

<span class="sd">        Each test for bad data outputs a status of True, None for each</span>
<span class="sd">        successful test. Unsuccessful tests add the problem to an error</span>
<span class="sd">        list to be returned at the end. That way, there is a relatively</span>
<span class="sd">        complete list of the problems encountered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># filtering first</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">required</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># data = self._remove_unnecessary_data(data)</span>

        <span class="c1"># check from standpoint of obj_params</span>
        <span class="k">for</span> <span class="n">col_key</span><span class="p">,</span> <span class="n">col_params</span> <span class="ow">in</span> <span class="n">obj_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">read_only</span> <span class="o">=</span> <span class="n">col_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;readOnly&quot;</span><span class="p">)</span>
            <span class="n">not_relation</span> <span class="o">=</span> <span class="s2">&quot;relationship&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">col_params</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">read_only</span> <span class="ow">and</span> <span class="n">not_relation</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col_key</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">col_key</span><span class="p">]</span>
                    <span class="c1"># find reasons to exclude</span>
                    <span class="n">tmp_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_numeric_casting</span><span class="p">(</span>
                        <span class="n">col_key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">col_params</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">tmp_errors</span><span class="p">:</span>
                        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tmp_errors</span><span class="p">)</span>

                    <span class="n">tmp_errors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_max_text_lengths</span><span class="p">(</span>
                        <span class="n">col_key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">col_params</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">tmp_errors</span><span class="p">:</span>
                        <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">tmp_errors</span><span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_date_conversions</span><span class="p">:</span>
                        <span class="n">dtstatus</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_date_casting</span><span class="p">(</span>
                            <span class="n">col_key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">col_params</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="n">dtstatus</span><span class="p">:</span>
                            <span class="n">data</span><span class="p">[</span><span class="n">col_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">errors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># is it required</span>
                    <span class="k">if</span> <span class="n">col_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;nullable&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                        <span class="n">required</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col_key</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">skip_missing_data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">required</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;missing_columns&quot;</span><span class="p">:</span> <span class="n">required</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">errors</span>

        <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">data</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_numeric_casting</span><span class="p">(</span><span class="n">col_key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">col_params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; _check_numeric_casting</span>

<span class="sd">        This function just makes a quick to see if a numeric field</span>
<span class="sd">        data, if in string form, can be converted to a number.</span>

<span class="sd">        No check is made on integer or float sizes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">col_params</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">():</span>
                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="p">{</span><span class="n">col_key</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;The value </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> is not a number&quot;</span><span class="p">}</span>
                    <span class="p">)</span>

        <span class="k">return</span> <span class="n">errors</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_check_max_text_lengths</span><span class="p">(</span><span class="n">col_key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">col_params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; _check_max_text_lengths</span>

<span class="sd">        This function compares a maximum length, if available with</span>
<span class="sd">        the data value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">max_len</span> <span class="o">=</span> <span class="n">col_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;maxLength&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_len</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="o">&gt;</span> <span class="n">max_len</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="n">col_key</span><span class="p">:</span> <span class="s2">&quot;The data exceeds the maximum length &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">max_len</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">}</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">errors</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_check_date_casting</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">col_key</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">col_params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; _check_date_casting</span>

<span class="sd">        This function attempts to change a string date to date object.</span>

<span class="sd">        Unlike the other checking functions, this function</span>
<span class="sd">        does a conversion to an object if possible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">col_params</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Date error: &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">col_key</span><span class="p">:</span> <span class="n">msg</span><span class="p">})</span>

        <span class="k">elif</span> <span class="n">col_params</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;date-time&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Date error: &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">col_key</span><span class="p">:</span> <span class="n">msg</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">errors</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">errors</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_item_adjust</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">status_code</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function receives a before/after commit</span>
<span class="sd">        function, item and default status_code</span>

<span class="sd">        Args:</span>
<span class="sd">            func: (func | obj) : either a function or an object.</span>
<span class="sd">            If it is an object, it must have a method of &#39;run&#39;.</span>
<span class="sd">            item: (obj) : The object that is being worked on</span>
<span class="sd">            status_code: (int) : the default status code associated</span>
<span class="sd">            with the HTTP method.</span>
<span class="sd">        Return:</span>
<span class="sd">            (status, result, status_code) : If the status is True, the</span>
<span class="sd">            processing will continue normally with `result` being the</span>
<span class="sd">            item that is  processed. The status_code can be changed</span>
<span class="sd">            or left to the default status code</span>
<span class="sd">            If the status is False, the result would be a JSON object that</span>
<span class="sd">            is to be returned to the front-end.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">status_code</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">status_code</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">output</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;function </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> must output a tuple of (status, &quot;</span>
            <span class="s2">&quot;result, status_code)&quot;</span>
        <span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo"><a href="../../../index.html">
  <img class="logo" src="../../../_static/flask-restful-dbbase-small.png" alt="Logo"
    style="margin-left: -10px"/>
</a></p>
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resource-classes.html">Resource Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../testing.html">Running Tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">(0.3,0) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id2">(0.2.5) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id4">(0.2.4) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id6">(0.2.3) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id8">(0.2.2) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id10">(0.2.1) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id11">(0.2.0) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id14">(0.1.11) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id16">(0.1.10) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id18">(0.1.9) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id20">(0.1.8) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id22">(0.1.7) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id25">(0.1.6) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id28">(0.1.5) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id30">(0.1.1) -</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id32">(0.1.0) -</a></li>
</ul>
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  <li><a href="../../flask_restful_dbbase.html">flask_restful_dbbase</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>



    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Don Smiley.
    </div>
    

 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle").show();
        $(".toggle").click(function() {
            $(this).children().not(".toggle").toggle(400);
            $(this).toggleClass("open");
        })
    });
</script>

  </body>
</html>